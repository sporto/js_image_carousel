var Carousel=function(p,U){var N=this;var I=p;var P;var O=0;var W=(typeof(U.showMultiple)==="undefined")?true:U.showMultiple;var Q=(typeof(U.centered)==="undefined")?true:U.centered;var m=[];var ai=0;var f=0;var R=[];var T=0;var D=[];var M=0;var H;var i;var n=true;var V=1000;var G=false;var L=[];var x;var Y=0;if(U.speed){V=U.speed}if(U.debug){G=U.debug}ab();function ab(){k("init");$("figure",I).hide();k("_showMultiple = "+W);$(window).load(function(){J()})}function J(){k("initWithImages");O=I.width();$("figure",I).wrapAll("<div class='movable' />");P=$(".movable",I);S();I.css("position","relative");I.css("overflow-x","hidden");P.css("position","absolute");C();l();$("figure",I).click(v);y();r();z();A()}function S(){k("processOriginalItems");m=$("figure",I);for(var ak=0,aj=m.length;ak<aj;ak++){ae(ak)}m.fadeTo(0,0.5);m.css("float","left");T=f}function ae(aj){k("processOriginalItem");var ak=$("figure",I).eq(aj);var al=ak.width();var am=$("figcaption",ak);L[aj]=am;am.hide();if(!W){ak.width(O);if(Q){ak.css("text-align","center")}al=O}R.push(al);D.push(al);f+=al;ai++}function l(){k("makePreItems");var aj=ai-1;k("clonedIndex "+aj);var ak=R[aj];k("clonedWidth "+ak);var al=$(m[aj]).clone();D.unshift(ak);T+=ak;P.prepend(al);j(-ak);X();M++;Y++}function C(){k("makePostItems");var ak=0;var aj=0;while((T)<(O*2.5)){ak++;if(ak>15){k("Too many!!!");break}if(aj>=ai){aj=0}E(aj);aj++}}function E(aj){k("clonePostItem "+aj);var ak=R[aj];k("clonedWidth "+ak);var al=$(m[aj]).clone();D.push(ak);T+=ak;P.append(al);X()}function X(){P.width(T)}function r(){H=$("<div class='arrow previous' />");i=$("<div class='arrow next' />");H.appendTo(I);i.appendTo(I);H.click(aa);i.click(ac)}function y(){x=$("<div class='caption' />");x.appendTo(I)}function aa(aj){if(n){ag()}}function ac(aj){if(n){ah()}}function v(ak){var aj=$(this).index();d(aj)}function ag(){s(-1)}function ah(){s(1)}function s(aj){d(M+aj)}function d(al){k("-------moveTo "+al);k("_currentIndex "+M);if(al===M){return}n=false;t(M);u();if(al===M){return}var aj=al-M;k("indexDif "+aj);var ak=0;if(al<M){ak=h();k("shifted "+ak);al+=(ak*ai)}if(al>M){ak=a();k("shifted "+ak);al-=(ak*ai)}k("new toIndex "+al);Z(M,al);M=al;z()}function K(al,am){if(al<0){throw ("fromIndex invalid "+al)}if(am<0){throw ("toIndex invalid "+am)}k("getDifference");k("fromIndex "+al);k("toIndex "+am);if(al===am){return 0}var ak=0;if(al>am){k("Backwards");for(var aj=am;aj<al;aj++){ak+=D[aj]}return ak}if(al<am){k("Forward");for(var aj=al;aj<am;aj++){ak+=D[aj]}return -ak}}function Z(ak,am){k("animate");k("fromIndex "+ak);k("toIndex"+am);var aj=K(ak,am);k("dif "+aj);var al=o()+aj;k("newLeft "+al);P.animate({left:al},V,c)}function c(){k("animateDone");n=true;q();A()}function q(){k("showItemCaption");var aj=m[M]}function o(){return P.position().left}function w(){return o()+B()}function b(aj){P.css("left",aj)}function B(){return T}function j(aj){b(o()+aj)}function h(){var aj=0;while(g()){aj++}return aj}function g(){k("shiftMovableOneLeft");var al=M+m.length;var ak=(w()-f)>=O;var aj=al<D.length;if(ak&&aj){j(-f);M=al;k("new currentIndex "+M);return true}else{k("Cannot more the movable left any further");return false}}function a(){var aj=0;while(F()){aj++}return aj}function F(){k("shiftMovableOneRight");var ak=M-m.length;k("newCurrentIndex "+ak);var aj=ak>=0;k("check "+aj);if(aj){j(f);M=ak;k("new currentIndex "+M);return true}else{k("Cannot move movable right any further");return false}}function z(){k("addCurrentHighlight "+M);af(M)}function af(aj){k("addHighlight "+aj);$("figure",I).eq(aj).fadeTo(0,1)}function t(aj){$("figure",I).eq(aj).fadeTo(0,0.5);$("figcaption",I).eq(aj).hide()}function A(){k("showCurrentCaption "+M);e(M-Y)}function e(aj){k("showCaption "+aj);aj=ad(aj);var ak=L[aj];ak.show();x.html(ak);x.fadeIn(500)}function u(){x.hide()}function ad(aj){return aj%m.length}function k(aj){if(!G){return}if(console.log){console.log(aj)}}};