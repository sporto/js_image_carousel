var Carousel=function(p,V){var O=this;var J=p;var Q;var P=0;var X=(typeof(V.showMultiple)==="undefined")?true:V.showMultiple;var R=(typeof(V.centered)==="undefined")?true:V.centered;var m=[];var aj=0;var f=0;var S=[];var U=0;var D=[];var N=0;var H;var i;var n=true;var W=1000;var G=false;var M=[];var x;var Z=0;if(V.speed){W=V.speed}if(V.debug){G=V.debug}ac();function ac(){k("init");$("figure",J).hide();$(window).load(function(){K()})}function K(){k("initWithImages");P=J.width();$("figure",J).wrapAll("<div class='movable' />");Q=$(".movable",J);T();J.css("position","relative");J.css("overflow-x","hidden");Q.css("position","absolute");C();l();$("figure",J).click(v);y();r();z();A()}function T(){k("processOriginalItems");m=$("figure",J);for(var al=0,ak=m.length;al<ak;al++){af(al)}m.fadeTo(0,0.5);m.css("float","left");U=f}function af(ak){k("processOriginalItem");var al=$("figure",J).eq(ak);var an=$("figcaption",al);M[ak]=an;an.hide();var am=al.width();if(!X){al.width(P);if(R){al.css("text-align","center")}am=P}S.push(am);D.push(am);f+=am;aj++}function l(){k("makePreItems");var ak=aj-1;k("clonedIndex "+ak);var al=S[ak];k("clonedWidth "+al);var am=$(m[ak]).clone();D.unshift(al);U+=al;Q.prepend(am);j(-al);Y();N++;Z++}function C(){k("makePostItems");var al=0;var ak=0;while((U)<(P*2.5)){al++;if(al>15){k("Too many!!!");break}if(ak>=aj){ak=0}E(ak);ak++}}function E(ak){k("clonePostItem "+ak);var al=S[ak];k("clonedWidth "+al);var am=$(m[ak]).clone();D.push(al);U+=al;Q.append(am);Y()}function Y(){k("resetMovableWidth");Q.width(U)}function r(){H=$("<div class='arrow previous' />");i=$("<div class='arrow next' />");H.appendTo(J);i.appendTo(J);H.click(ab);i.click(ad)}function y(){x=$("<div class='caption' />");x.appendTo(J)}function ab(ak){if(n){ah()}}function ad(ak){if(n){ai()}}function v(al){var ak=$(this).index();d(ak)}function ah(){s(-1)}function ai(){s(1)}function s(ak){d(N+ak)}function d(am){k("-------moveTo "+am);k("_currentIndex "+N);if(am===N){return}n=false;t(N);u();if(am===N){return}var ak=am-N;k("indexDif "+ak);var al=0;if(am<N){al=h();k("shifted "+al);am+=(al*aj)}if(am>N){al=a();k("shifted "+al);am-=(al*aj)}k("new toIndex "+am);aa(N,am);N=am;z()}function L(am,an){if(am<0){throw ("fromIndex invalid "+am)}if(an<0){throw ("toIndex invalid "+an)}k("getDifference");k("fromIndex "+am);k("toIndex "+an);if(am===an){return 0}var al=0;if(am>an){k("Backwards");for(var ak=an;ak<am;ak++){al+=D[ak]}return al}if(am<an){k("Forward");for(var ak=am;ak<an;ak++){al+=D[ak]}return -al}}function aa(al,an){k("animate");k("fromIndex "+al);k("toIndex"+an);var ak=L(al,an);k("dif "+ak);var am=o()+ak;k("newLeft "+am);Q.animate({left:am},W,c)}function c(){k("animateDone");n=true;q();A();I()}function q(){k("showItemCaption");var ak=m[N]}function o(){return Q.position().left}function w(){return o()+B()}function b(ak){Q.css("left",ak)}function B(){return U}function j(ak){k("moveMovable "+ak);b(o()+ak)}function I(){k("resetMovablePosition");k(N);var al=0;for(var ak=0;ak<N;ak++){al+=D[ak]}k(-al);b(-al)}function h(){var ak=0;while(g()){ak++}return ak}function g(){k("shiftMovableOneLeft");var am=N+m.length;var al=(w()-f)>=P;var ak=am<D.length;if(al&&ak){j(-f);N=am;k("new currentIndex "+N);return true}else{k("Cannot more the movable left any further");return false}}function a(){var ak=0;while(F()){ak++}return ak}function F(){k("shiftMovableOneRight");var al=N-m.length;k("newCurrentIndex "+al);var ak=al>=0;k("check "+ak);if(ak){j(f);N=al;k("new currentIndex "+N);return true}else{k("Cannot move movable right any further");return false}}function z(){k("addCurrentHighlight "+N);ag(N)}function ag(ak){k("addHighlight "+ak);$("figure",J).eq(ak).fadeTo(0,1)}function t(ak){$("figure",J).eq(ak).fadeTo(0,0.5);$("figcaption",J).eq(ak).hide()}function A(){k("showCurrentCaption "+N);e(N-Z)}function e(ak){k("showCaption "+ak);ak=ae(ak);var al=M[ak];al.show();x.html(al);x.fadeIn(500)}function u(){x.hide()}function ae(ak){if(ak<0){return m.length-1}return ak%m.length}function k(ak){if(!G){return}if(console.log){console.log(ak)}}};